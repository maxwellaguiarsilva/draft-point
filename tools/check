#!/usr/bin/bash


#	function to ensure correct file extensions in source/ and include/ directories
file_name_extension( )
{
	local -i errors=0

	#	check source/ directory for .cpp extension
	while read -r file;
	do
		if [[ -f "${file}" ]]
		then
			local extension="${file##*.}"
			if [[ "${extension}" != "cpp" ]]
			then
				printf %b "error: file '${file}' has incorrect extension '.${extension}'\nexpected '.cpp'\n"
				errors=$(( errors + 1 ))
			fi
		fi
	done <<< "$( find source/ -type f )"

	#	check include/ directory for .hpp extension
	while read -r file;
	do
		if [[ -f "${file}" ]]
		then
			local extension="${file##*.}"
			if [[ "${extension}" != "hpp" ]]
			then
				printf %b "error: file '${file}' in include/ has incorrect extension '.${extension}'\nexpected '.hpp'\n"
				errors=$(( errors + 1 ))
			fi
		fi
	done <<< "$( find include/ -type f )"

	if [[ "${errors}" -eq 0 ]];
	then
		printf %b "all file extensions are correct\n"
	else
		printf %b "found ${errors} file extension errors\n"
		return 1
	fi
}

#	main script logic to invoke functions based on arguments
for arg in "${@}";
do
	#	replace hyphens with underscores to match function names
	function_name="${arg//-/_}"

	#	check if the function exists and then call it
	if declare -f "${function_name}" > /dev/null;
	then
		"${function_name}"
	else
		printf %b "error: function '${function_name}' not found\n"
		exit 1
	fi
done


